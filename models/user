var db = require("./../app").db;

function UserSerializer(row){
    this.user = {};
    this.user.firstName=row.firstName;
    this.user.lastName=row.lastName;
    this.user.email=row.email;
    this.user.username=row.username;
    this.user.password=row.password;
    if (row.userEnable == undefined){
        this.user.userEnable=false;
    } else {
        this.user.userEnable=true;
    }
    this.user.GroupId=row.GroupId;
    this.user.language=row.language;
}

UserSerializer.prototype.updateDB = function(userId, callback){
    db.updateDB("User", userId, this.user, function(err){
        if (err){
            callback(err);
        }
        console.log("User UpdateDB");
        callback(err);
    });
};

UserSerializer.prototype.insertDB = function(callback){
    db.insertDB("User", this.user, function(err){
        if (err){
            callback(err);
        }
        callback(err);
    });
};

function User(){
    this.userId=null;
    this.firstName="";
    this.lastName="";
    this.email="";
    this.username="";
    this.password="";
    this.userEnable=true;
    this.lastLogin="";
    this.GroupId="";
    this.language="";
}

findOne = function(fields, options, callback){
    db.findOne("User", fields, options, function(err, user){
        if (err){
            callback(err);
        }
        callback(err, user);
    });
};

findById = function(rowId, options, callback){
    db.findById("User", rowId, options, function(err, user){
        if (err){
            return err;
        }
        callback(err, user);
    });
};

getAll = function(options, callback){
    var options = options || {"orderBy":"username"};
    db.getAll("User", options, function(err, users){
        if (err){
            return err;
        }
        callback(err, users);
    })
};

module.exports = User;
module.exports.findOne = findOne;
module.exports.findById = findById;
module.exports.getAll = getAll;
module.exports.UserSerializer = UserSerializer;